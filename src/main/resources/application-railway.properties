# Railway Deployment Configuration
# This profile is specifically for Railway deployment

# Server Configuration
server.port=${PORT:8080}

# Ensure application starts even with database issues
spring.autoconfigure.exclude=org.springframework.boot.autoconfigure.jdbc.DataSourceAutoConfiguration
spring.jpa.hibernate.ddl-auto=none
spring.jpa.show-sql=false
spring.jpa.properties.hibernate.format_sql=false
spring.jpa.properties.hibernate.hbm2ddl.auto=none
spring.jpa.properties.hibernate.hbm2ddl.schema_generation.drop_source=metadata
spring.jpa.properties.hibernate.hbm2ddl.schema_generation.create_source=metadata

# Disable all database-related auto-configuration
spring.autoconfigure.exclude=org.springframework.boot.autoconfigure.orm.jpa.HibernateJpaAutoConfiguration

# Database Configuration - Railway MySQL
# The MySQLConfig class will handle the actual database connection
# This is a fallback configuration
spring.datasource.url=${MYSQL_URL:${DATABASE_URL:jdbc:mysql://localhost:3306/dump_truck_db}}
spring.datasource.username=${MYSQLUSER:${DB_USERNAME:root}}
spring.datasource.password=${MYSQLPASSWORD:${DB_PASSWORD:}}
spring.datasource.driver-class-name=com.mysql.cj.jdbc.Driver

# JPA Configuration for Railway
spring.jpa.hibernate.ddl-auto=none
spring.jpa.show-sql=false
spring.jpa.properties.hibernate.format_sql=false
spring.jpa.properties.hibernate.hbm2ddl.auto=none
spring.jpa.properties.hibernate.hbm2ddl.schema_generation.drop_source=metadata
spring.jpa.properties.hibernate.hbm2ddl.schema_generation.create_source=metadata

# Database-specific dialect will be set by MySQLConfig

# Email Configuration
spring.mail.host=${MAIL_HOST:smtp-relay.brevo.com}
spring.mail.port=${MAIL_PORT:587}
spring.mail.username=${MAIL_USERNAME:}
spring.mail.password=${MAIL_PASSWORD:}
spring.mail.properties.mail.smtp.auth=true
spring.mail.properties.mail.smtp.starttls.enable=true

# Application Configuration
app.email.from=${APP_EMAIL_FROM:}
app.email.verification-url=${APP_URL:}/verify

# Security Configuration
spring.security.csrf.enabled=true
spring.security.headers.frame-options=DENY
spring.security.headers.content-security-policy=default-src 'self'

# Logging Configuration for Railway
logging.level.root=INFO
logging.level.com.shteotkacha=INFO
logging.level.org.springframework.web=INFO
logging.level.org.hibernate.SQL=WARN
logging.level.org.hibernate.type.descriptor.sql.BasicBinder=WARN

# Actuator Configuration for Health Checks
management.endpoints.web.exposure.include=health,info
management.endpoint.health.show-details=when-authorized
management.health.db.enabled=true

# Completely disable metrics to avoid container issues
management.metrics.enable.all=false
management.metrics.export.simple.enabled=false
management.metrics.enable.process=false
management.metrics.enable.jvm=false
management.metrics.enable.system=false
management.metrics.enable.logback=false
management.metrics.enable.tomcat=false
management.metrics.enable.hikaricp=false
management.metrics.enable.processor=false
management.metrics.enable.cpu=false
management.metrics.enable.memory=false

# Disable all metric binders
management.metrics.binders.process.enabled=false
management.metrics.binders.system.enabled=false
management.metrics.binders.processor.enabled=false
management.metrics.binders.cpu.enabled=false
management.metrics.binders.memory.enabled=false
management.metrics.binders.jvm.enabled=false
management.metrics.binders.logback.enabled=false
management.metrics.binders.tomcat.enabled=false
management.metrics.binders.hikaricp.enabled=false 